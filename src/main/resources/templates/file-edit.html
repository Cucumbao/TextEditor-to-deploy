<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>–†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—É</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>

<header>
    <h1>TextEditor</h1>
    <div class="user-info" th:if="${currentUser != null}">
        <span th:text="${currentUser.username}"></span>
        <a th:href="@{/logout}" class="logout">–í–∏–π—Ç–∏</a>
    </div>
</header>

<div class="container" style="flex-direction: column; display: flex; height: 90%;">
    <div class="editor-controls" style=" margin-bottom: 10px; display: flex; gap: 10px;">
        <!-- –ö–æ–º–∞–Ω–¥–∏ —Ä–µ–¥—É —Ç–∞ –∞–Ω–¥—É -->
        <form th:action="@{/files/{id}/undo(id=${file.id})}" method="post">
            <button type="submit" class="button">‚Ü∂ Undo</button>
        </form>
        <form th:action="@{/files/{id}/redo(id=${file.id})}" method="post">
            <button type="submit" class="button">‚Ü∑ Redo</button>
        </form>

        <button type="button" class="button" id="openSnippetListModal">üìÑ –°–Ω—ñ–ø–ø–µ—Ç–∏</button>
        <button type="button" class="button" id="openMacroListModal">‚öôÔ∏è –ú–∞–∫—Ä–æ—Å–∏</button>
        <button type="button" class="button" id="openBookmarkListModal">üîñ –ó–∞–∫–ª–∞–¥–∫–∏</button>
        <button type="button" class="button" onclick="transformSelection('upper')" style="cursor: pointer;">AA</button>
        <button type="button" class="button" onclick="transformSelection('lower')" style="cursor: pointer;">aa</button>
        <button type="button" class="button" onclick="transformSelection('sentence')" title="–Ø–∫ —É —Ä–µ—á–µ–Ω–Ω—è—Ö">Aa</button>

    </div>
    <!-- –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—É -->
    <form th:action="@{|/files/${file.id}/edit|}" method="post" style="flex:1; display:flex; flex-direction:column;">
        <input id="fileName" name="name" th:value="${file.fileName}">
        <textarea id="fileContent" name="content" th:text="${fileContent}" th:attr="data-file-id=${file.id}" style="flex:1;"></textarea>
        <div class="actions" style="margin-top:10px; justify-content:flex-end;">
            <button type="submit" class="button">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏</button>
            <a th:href="@{/files/{id}/download(id=${file.id})}" class="button" style="text-decoration: none;">
                –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –Ω–∞ –ü–ö
            </a>
            <a th:href="@{|/files/${file.id}|}" class="button">–ù–∞–∑–∞–¥</a>
        </div>
    </form>
</div>

<!-- ------------------ –ú–æ–¥–∞–ª–∫–∏ –ó–∞–∫–ª–∞–¥–æ–∫ ------------------ -->
<div id="bookmarkListModal" class="modal" style="display:none;">
    <div class="modal-content">
        <span class="close-modal">&times;</span>
        <h2>üîñ –ó–∞–∫–ª–∞–¥–∫–∏ —É —Ñ–∞–π–ª—ñ</h2>
        <div style="max-height: 300px; overflow-y:auto; padding:5px;">
            <th:block th:each="bm : ${bookmarks}">
                <div class="bookmark-item" style="display:flex; justify-content:space-between; align-items:center; padding:6px; border-bottom:1px solid #eee;">

                    <div style="flex: 1;">
                        <button type="button" class="button" style="background-color: #f0f0f0; color: #333;"
                                th:onclick="'jumpToLine(' + ${bm.lineNumber} + ')'">
                            Go to <b th:text="${bm.lineNumber}"></b>
                        </button>
                        <span th:text="${bm.description}" style="margin-left: 10px; font-style: italic;">–û–ø–∏—Å</span>
                    </div>

                    <button type="button" class="edit-bookmark button" style="margin-left:5px;"
                            th:data-id="${bm.id}" th:data-line="${bm.lineNumber}" th:data-desc="${bm.description}">‚úèÔ∏è</button>

                    <form th:action="@{/bookmarks/{id}/delete(id=${bm.id})}" method="post" style="margin-left:10px;">
                        <input type="hidden" name="fileId" th:value="${file.id}">
                        <button type="submit" style="background:none; border:none; color:red; font-size:18px; cursor:pointer;">‚ùå</button>
                    </form>
                </div>
            </th:block>
            <div th:if="${#lists.isEmpty(bookmarks)}" style="text-align: center; color: gray; padding: 10px;">
                –ó–∞–∫–ª–∞–¥–æ–∫ —â–µ –Ω–µ–º–∞—î
            </div>
        </div>
        <button type="button" onclick="openCreateBookmarkModalWithCurrentLine()" class="button" style="margin-top:15px;">‚ûï –î–æ–¥–∞—Ç–∏ –∑–∞–∫–ª–∞–¥–∫—É (–ø–æ—Ç–æ—á–Ω–∏–π —Ä—è–¥–æ–∫)</button>
    </div>
</div>

<div id="createBookmarkModal" class="modal" style="display:none;">
    <div class="modal-content">
        <span class="close-modal">&times;</span>
        <h2>–î–æ–¥–∞—Ç–∏ –∑–∞–∫–ª–∞–¥–∫—É</h2>
        <form th:action="@{/bookmarks/create}" method="post">
            <input type="hidden" name="fileId" th:value="${file.id}">

            <label for="newBookmarkLine">–ù–æ–º–µ—Ä —Ä—è–¥–∫–∞:</label>
            <input type="number" id="newBookmarkLine" name="lineNumber" required style="width:100px; margin-bottom:10px;">

            <label for="newBookmarkDesc">–û–ø–∏—Å:</label>
            <input type="text" id="newBookmarkDesc" name="description" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: –í–∞–∂–ª–∏–≤–∞ —Ñ—É–Ω–∫—Ü—ñ—è" required style="width:100%; margin-bottom:10px;">

            <button type="submit" class="button">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏</button>
        </form>
    </div>
</div>

<div id="editBookmarkModal" class="modal" style="display:none;">
    <div class="modal-content">
        <span class="close-modal">&times;</span>
        <h2>–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –∑–∞–∫–ª–∞–¥–∫—É</h2>
        <form id="editBookmarkForm" method="post">
            <input type="hidden" name="fileId" th:value="${file.id}">
            <input type="hidden" name="id" id="editBookmarkId">

            <label for="editBookmarkLine">–ù–æ–º–µ—Ä —Ä—è–¥–∫–∞:</label>
            <input type="number" id="editBookmarkLine" name="lineNumber" required style="width:100px; margin-bottom:10px;">

            <label for="editBookmarkDesc">–û–ø–∏—Å:</label>
            <input type="text" id="editBookmarkDesc" name="description" required style="width:100%; margin-bottom:10px;">

            <button type="submit" class="button">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏</button>
        </form>
    </div>
</div>

<!-- ------------------ –ú–æ–¥–∞–ª–∫–∏ –°–Ω—ñ–ø–µ—Ç—ñ–≤ ------------------ -->
<div id="snippetListModal" class="modal" style="display:none;">
    <div class="modal-content">
        <span class="close-modal" style="cursor:pointer; float:right;">&times;</span>
        <h2>–í–∞—à—ñ —Å–Ω—ñ–ø–ø–µ—Ç–∏</h2>

        <div style="max-height: 300px; overflow-y:auto; padding:5px;">
            <th:block th:each="snippet : ${snippets}">
                <div class="snippet-item" style="display:flex; justify-content:space-between; align-items:center; padding:6px; border-bottom:1px solid #eee;">

                    <form th:action="@{/snippets/{id}/insert(id=${snippet.id})}" method="post" onsubmit="captureCursor(this)" style="display:inline; width: auto; flex: 1;">
                        <input type="hidden" name="fileId" th:value="${file.id}">
                        <input type="hidden" name="cursorPosition" class="cursor-input" value="-1">

                        <button type="submit" class="button item-name-btn" th:text="${snippet.name}">
                            –í—Å—Ç–∞–≤–∏—Ç–∏
                        </button>
                    </form>

                    <div style="display: flex; align-items: center;">
                        <button type="button" class="edit-snippet button" style="margin-left:5px;"
                                th:data-id="${snippet.id}" th:data-name="${snippet.name}" th:data-content="${snippet.content}">‚úèÔ∏è</button>

                        <form th:action="@{/snippets/{id}/delete(id=${snippet.id})}" method="post" style="margin-left:5px;">
                            <input type="hidden" name="fileId" th:value="${file.id}">
                            <button type="submit" style="background:none; border:none; color:red; font-size:18px; cursor:pointer;">‚ùå</button>
                        </form>
                    </div>
                </div>
            </th:block>
            <div th:if="${#lists.isEmpty(snippets)}" style="text-align: center; color: gray; padding: 10px;">
                –°–Ω—ñ–ø–ø–µ—Ç—ñ–≤ —â–µ –Ω–µ–º–∞—î
            </div>
        </div>
        <button type="button" id="openCreateSnippetModalBtn" class="button" style="margin-top:15px;">‚ú® –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π —Å–Ω—ñ–ø–ø–µ—Ç</button>
    </div>
</div>
<!-- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ —Å–Ω—ñ–ø–µ—Ç—É -->
<div id="createSnippetModal" class="modal" style="display:none;">
    <div class="modal-content">
        <span class="close-create-snippet">&times;</span>
        <h2>–°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π —Å–Ω—ñ–ø–ø–µ—Ç</h2>
        <form th:action="@{/snippets/create}" method="post">
            <input type="hidden" name="fileId" th:value="${file.id}">
            <label for="newSnippetName">–ù–∞–∑–≤–∞:</label>
            <input type="text" id="newSnippetName" name="name" required style="width:100%; margin-bottom:10px;">
            <label for="newSnippetContent">–í–º—ñ—Å—Ç:</label>
            <textarea id="newSnippetContent" name="content" required style="width:100%; height:150px;"></textarea>
            <button type="submit" class="button">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏</button>
        </form>
    </div>
</div>
<!-- –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —Å–Ω—ñ–ø–µ—Ç—É -->
<div id="editSnippetModal" class="modal" style="display:none;">
    <div class="modal-content">
        <span class="close-edit-snippet">&times;</span>
        <h2>–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ —Å–Ω—ñ–ø–µ—Ç</h2>
        <form id="editSnippetForm" method="post">
            <input type="hidden" name="fileId" th:value="${file.id}">
            <input type="hidden" name="id" id="editSnippetId">
            <label for="editSnippetName">–ù–∞–∑–≤–∞:</label>
            <input type="text" id="editSnippetName" name="name" required style="width:100%; margin-bottom:10px;">
            <label for="editSnippetContent">–í–º—ñ—Å—Ç:</label>
            <textarea id="editSnippetContent" name="content" required style="width:100%; height:150px;"></textarea>
            <button type="submit" class="button">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏</button>
        </form>
    </div>
</div>

<!-- ------------------ –ú–æ–¥–∞–ª–∫–∏ –ú–∞–∫—Ä–æ—Å—ñ–≤ ------------------ -->
<div id="macroListModal" class="modal" style="display:none;">
    <div class="modal-content">
        <span class="close-modal" style="cursor:pointer; float:right;">&times;</span>
        <h2>–í–∞—à—ñ –º–∞–∫—Ä–æ—Å–∏</h2>

        <div style="max-height: 300px; overflow-y:auto; padding:5px;">
            <th:block th:each="macro : ${macros}">
                <div class="macro-item" style="display:flex; justify-content:space-between; align-items:center; padding:6px; border-bottom:1px solid #eee;">

                    <form th:action="@{/macros/{id}/insert(id=${macro.id})}" method="post" onsubmit="captureCursor(this)" style="display:inline; width: auto; flex: 1;">
                        <input type="hidden" name="fileId" th:value="${file.id}">
                        <input type="hidden" name="cursorPosition" class="cursor-input" value="-1">

                        <button type="submit" class="button item-name-btn" th:text="${macro.name}">
                            –í—Å—Ç–∞–≤–∏—Ç–∏
                        </button>
                    </form>

                    <div style="display: flex; align-items: center;">
                        <button type="button" class="edit-macro button" style="margin-left:5px;"
                                th:data-id="${macro.id}" th:data-name="${macro.name}" th:data-commands="${macro.commands}">‚úèÔ∏è</button>

                        <form th:action="@{/macros/{id}/delete(id=${macro.id})}" method="post" style="margin-left:5px;">
                            <input type="hidden" name="fileId" th:value="${file.id}">
                            <button type="submit" style="background:none; border:none; color:red; font-size:18px; cursor:pointer;">‚ùå</button>
                        </form>
                    </div>
                </div>
            </th:block>
            <div th:if="${#lists.isEmpty(macros)}" style="text-align: center; color: gray; padding: 10px;">
                –ú–∞–∫—Ä–æ—Å—ñ–≤ —â–µ –Ω–µ–º–∞—î
            </div>
        </div>
        <button type="button" id="openCreateMacroModalBtn" class="button" style="margin-top:15px;">‚ú® –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π –º–∞–∫—Ä–æ—Å</button>
    </div>
</div>
<!-- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –º–∞–∫—Ä–æ—Å—É -->
<div id="createMacroModal" class="modal" style="display:none;">
    <div class="modal-content">
        <span class="close-create-macro">&times;</span>
        <h2>–°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π –º–∞–∫—Ä–æ—Å</h2>
        <form th:action="@{/macros/create}" method="post">
            <input type="hidden" name="fileId" th:value="${file.id}">
            <label for="newMacroName">–ù–∞–∑–≤–∞ –º–∞–∫—Ä–æ—Å—É:</label>
            <input type="text" id="newMacroName" name="name" required style="width:100%; margin-bottom:10px;">
            <label for="newMacroCommands">–ö–æ–º–∞–Ω–¥–∏:</label>
            <textarea id="newMacroCommands" name="commands" required style="width:100%; height:150px;"></textarea>
            <button type="submit" class="button">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏</button>
        </form>
    </div>
</div>
<!-- –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –º–∞–∫—Ä–æ—Å—É -->
<div id="editMacroModal" class="modal" style="display:none;">
    <div class="modal-content">
        <span class="close-edit-macro">&times;</span>
        <h2>–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –º–∞–∫—Ä–æ—Å</h2>
        <form id="editMacroForm" method="post">
            <input type="hidden" name="fileId" th:value="${file.id}">
            <input type="hidden" name="id" id="editMacroId">
            <label for="editMacroName">–ù–∞–∑–≤–∞:</label>
            <input type="text" id="editMacroName" name="name" required style="width:100%; margin-bottom:10px;">
            <label for="editMacroCommands">–ö–æ–º–∞–Ω–¥–∏:</label>
            <textarea id="editMacroCommands" name="commands" required style="width:100%; height:150px;"></textarea>
            <button type="submit" class="button">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏</button>
        </form>
    </div>
</div>

<script>
    const editor = document.getElementById("fileContent");
    const fileId = editor.dataset.fileId;
    let lastCursorPosition = -1;

    // --- –í—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –∫—É—Ä—Å–æ—Ä–∞ ---
    ['click', 'keyup', 'input', 'focus'].forEach(evt =>
        editor.addEventListener(evt, () => {
            lastCursorPosition = editor.selectionStart;
        })
    );
    function getCurrentLineNumber() {
        if (!editor) return 1;
        const textUpToCursor = editor.value.substr(0, editor.selectionStart);
        return textUpToCursor.split("\n").length;
    }

    // 2. –í—ñ–¥–∫—Ä–∏—Ç—Ç—è –º–æ–¥–∞–ª–∫–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–∞–∫–ª–∞–¥–∫–∏ (–ø—ñ–¥—Å—Ç–∞–≤–ª—è—î —Ä—è–¥–æ–∫)
    function openCreateBookmarkModalWithCurrentLine() {
        const lineNum = getCurrentLineNumber();
        document.getElementById("newBookmarkLine").value = lineNum;

        // –ó–∞–∫—Ä–∏–≤–∞—î–º–æ —Å–ø–∏—Å–æ–∫, –≤—ñ–¥–∫—Ä–∏–≤–∞—î–º–æ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è
        document.getElementById("bookmarkListModal").style.display = "none";
        document.getElementById("createBookmarkModal").style.display = "block";
    }

    // 3. –§—É–Ω–∫—Ü—ñ—è –ø–µ—Ä–µ—Ö–æ–¥—É –¥–æ —Ä—è–¥–∫–∞ (Jump)
    function jumpToLine(lineNumber) {
        if (!editor) return;
        document.getElementById("bookmarkListModal").style.display = "none";
        const lines = editor.value.split("\n");
        let charIndex = 0;

        for (let i = 0; i < lineNumber - 1; i++) {
            if (i < lines.length) {
                charIndex += lines[i].length + 1;
            }
        }
        editor.focus();
        editor.setSelectionRange(charIndex, charIndex);
        editor.blur();
        editor.focus();
    }


    // --- –ö–µ—Ä—É–≤–∞–Ω–Ω—è –º–æ–¥–∞–ª–∫–∞–º–∏ ---
    const modals = {
        snippetList: document.getElementById("snippetListModal"),
        createSnippet: document.getElementById("createSnippetModal"),
        editSnippet: document.getElementById("editSnippetModal"),
        macroList: document.getElementById("macroListModal"),
        createMacro: document.getElementById("createMacroModal"),
        editMacro: document.getElementById("editMacroModal"),
        bookmarkList: document.getElementById("bookmarkListModal"),
        createBookmark: document.getElementById("createBookmarkModal"),
        editBookmark: document.getElementById("editBookmarkModal")
    };

    // –í—ñ–¥–∫—Ä–∏—Ç—Ç—è —Å–ø–∏—Å–∫—ñ–≤
    document.getElementById("openSnippetListModal")?.addEventListener("click", () => modals.snippetList.style.display = "block");
    document.getElementById("openMacroListModal")?.addEventListener("click", () => modals.macroList.style.display = "block");
    document.getElementById("openBookmarkListModal")?.addEventListener("click", () => modals.bookmarkList.style.display = "block");

    // –ö–Ω–æ–ø–∫–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –º–æ–¥–∞–ª–æ–∫
    document.getElementById("openCreateSnippetModalBtn")?.addEventListener("click", () => modals.createSnippet.style.display = "block");
    document.getElementById("openCreateMacroModalBtn")?.addEventListener("click", () => modals.createMacro.style.display = "block");

    // –ó–∞–∫—Ä–∏—Ç—Ç—è (—Ö—Ä–µ—Å—Ç–∏–∫)
    document.querySelectorAll(".close-modal").forEach(btn =>
        btn.addEventListener("click", () => btn.closest(".modal").style.display = "none")
    );

    // –ó–∞–∫—Ä–∏—Ç—Ç—è –ø–æ –∫–ª—ñ–∫—É –∑–∞ –º–µ–∂—ñ
    window.onclick = event => {
        Object.values(modals).forEach(modal => {
            if (event.target === modal) modal.style.display = "none";
        });
    };

    // –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –°–Ω—ñ–ø–µ—Ç—ñ–≤
    document.querySelectorAll(".edit-snippet").forEach(btn => {
        btn.addEventListener("click", () => {
            document.getElementById("editSnippetId").value = btn.dataset.id;
            document.getElementById("editSnippetName").value = btn.dataset.name;
            document.getElementById("editSnippetContent").value = btn.dataset.content;
            document.getElementById("editSnippetForm").action = `/snippets/${btn.dataset.id}/update`;
            modals.editSnippet.style.display = "block";
        });
    });

    // –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –ú–∞–∫—Ä–æ—Å—ñ–≤
    document.querySelectorAll(".edit-macro").forEach(btn => {
        btn.addEventListener("click", () => {
            document.getElementById("editMacroId").value = btn.dataset.id;
            document.getElementById("editMacroName").value = btn.dataset.name;
            document.getElementById("editMacroCommands").value = btn.dataset.commands;
            document.getElementById("editMacroForm").action = `/macros/${btn.dataset.id}/update`;
            modals.editMacro.style.display = "block";
        });
    });

    // –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –ó–∞–∫–ª–∞–¥–æ–∫
    document.querySelectorAll(".edit-bookmark").forEach(btn => {
        btn.addEventListener("click", () => {
            document.getElementById("editBookmarkId").value = btn.dataset.id;
            document.getElementById("editBookmarkLine").value = btn.dataset.line;
            document.getElementById("editBookmarkDesc").value = btn.dataset.desc;
            document.getElementById("editBookmarkForm").action = `/bookmarks/${btn.dataset.id}/update`;
            modals.editBookmark.style.display = "block";
        });
    });


    // --- –Ü–Ω—à–µ (–ê–≤—Ç–æ–∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ç–∞ cursor) ---
    let timeout;
    editor.addEventListener("input", () => {
        clearTimeout(timeout);
        timeout = setTimeout(() => {
            fetch(`/files/${fileId}/storage`, {
                method: "POST",
                headers: { "Content-Type": "application/x-www-form-urlencoded" },
                body: `content=${encodeURIComponent(editor.value)}&name=${encodeURIComponent(document.getElementById("fileName").value)}`
            });
        }, 500);
    });

    function captureCursor(formElement) {
        let hiddenInput = formElement.querySelector('.cursor-input');
        if(hiddenInput) hiddenInput.value = lastCursorPosition;
        return true;
    }

    async function transformSelection(type) {
        const start = editor.selectionStart;
        const end = editor.selectionEnd;
        const selectedText = editor.value.substring(start, end);

        if (!selectedText) {
            alert("–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–∏–¥—ñ–ª—ñ—Ç—å —Ç–µ–∫—Å—Ç –¥–ª—è —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è!");
            return;
        }
        const formData = new FormData();
        formData.append('text', selectedText);
        formData.append('type', type);
        try {
            const response = await fetch('/files/transform', {
                method: 'POST',
                body: formData
            });
            if (response.ok) {
                const newText = await response.text();
                editor.setRangeText(newText, start, end, 'select');
                editor.dispatchEvent(new Event('input'));
            } else {
                console.error("–ü–æ–º–∏–ª–∫–∞ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—ó");
                alert("–ü–æ–º–∏–ª–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ –ø—Ä–∏ –∑–º—ñ–Ω—ñ —Ä–µ–≥—ñ—Å—Ç—Ä—É.");
            }
        } catch (error) {
            console.error("Error:", error);
            alert("–ü–æ–º–∏–ª–∫–∞ –∑'—î–¥–Ω–∞–Ω–Ω—è.");
        }
    }
</script>
</body>
</html>
